@page "/modals"
@inject IModalService ModalService

<PageTitle>Modals</PageTitle>

<h1 class="text-3xl font-bold mb-6">Modal Component</h1>

<BlazyAlert Color="BlazyAlertColor.Info" Class="mb-6"><span><strong>Setup:</strong> Add <BlazyKbd>&lt;ModalProvider /&gt;</BlazyKbd> to your MainLayout.razor or App.razor to enable modal dialogs.</span></BlazyAlert>

<section class="mb-8">
    <h2 class="text-xl font-semibold mb-4">Simple Dialogs</h2>
    <CodeExample Code="@simpleDialogsCode">
        <div class="flex flex-wrap gap-2">
            <BlazyButton Color="BlazyButtonColor.Info" OnClick="ShowInfo">Info</BlazyButton>
            <BlazyButton Color="BlazyButtonColor.Warning" OnClick="ShowWarning">Warning</BlazyButton>
            <BlazyButton Color="BlazyButtonColor.Error" OnClick="ShowError">Error</BlazyButton>
        </div>
    </CodeExample>
</section>

<section class="mb-8">
    <h2 class="text-xl font-semibold mb-4">Confirmation Dialog</h2>
    <CodeExample Code="@confirmDialogCode">
        <div class="flex flex-wrap items-center gap-4">
            <BlazyButton Color="BlazyButtonColor.Primary" OnClick="ShowConfirm">Delete Item</BlazyButton>
            @if (confirmResult != null)
            {
                <span class="text-sm">
                    Result: <strong>@(confirmResult.Value ? "Confirmed" : "Cancelled")</strong>
                </span>
            }
        </div>
    </CodeExample>
</section>

<section class="mb-8">
    <h2 class="text-xl font-semibold mb-4">Custom Button Text</h2>
    <CodeExample Code="@customButtonsCode">
        <div class="flex flex-wrap gap-2">
            <BlazyButton Color="BlazyButtonColor.Success" OnClick="ShowCustomButtons">Save Changes</BlazyButton>
        </div>
    </CodeExample>
</section>

<section class="mb-8">
    <h2 class="text-xl font-semibold mb-4">Custom Component Modal</h2>
    <CodeExample Code="@customComponentCode">
        <div class="flex flex-wrap items-center gap-4">
            <BlazyButton Color="BlazyButtonColor.Secondary" OnClick="ShowEditUser">Edit User</BlazyButton>
            @if (!string.IsNullOrEmpty(editedUserName))
            {
                <span class="text-sm">
                    Updated name: <strong>@editedUserName</strong>
                </span>
            }
        </div>
    </CodeExample>
</section>

@code {
    private bool? confirmResult;
    private string? editedUserName;

    private async Task ShowInfo()
    {
        await ModalService.Info("Information", "This is an informational message.");
    }

    private async Task ShowWarning()
    {
        await ModalService.Warning("Warning", "This action may have consequences.");
    }

    private async Task ShowError()
    {
        await ModalService.Error("Error", "Something went wrong. Please try again.");
    }

    private async Task ShowConfirm()
    {
        confirmResult = await ModalService.Confirm(
            "Delete Item",
            "Are you sure you want to delete this item? This action cannot be undone.");
    }

    private async Task ShowCustomButtons()
    {
        await ModalService.Confirm(
            "Unsaved Changes",
            "You have unsaved changes. Do you want to save them before leaving?",
            confirmText: "Save",
            cancelText: "Discard");
    }

    private async Task ShowEditUser()
    {
        var parameters = new Dictionary<string, object>
        {
            ["UserName"] = "John Doe"
        };

        var result = await ModalService.Show<EditUserModal, string>(
            parameters,
            options => options.CssClass = "max-w-md");

        if (result.Confirmed && result.Data != null)
        {
            editedUserName = result.Data;
        }
    }

    private string simpleDialogsCode = @"@inject IModalService ModalService

<BlazyButton Color=""BlazyButtonColor.Info"" OnClick=""ShowInfo"">Info</BlazyButton>
<BlazyButton Color=""BlazyButtonColor.Warning"" OnClick=""ShowWarning"">Warning</BlazyButton>
<BlazyButton Color=""BlazyButtonColor.Error"" OnClick=""ShowError"">Error</BlazyButton>

@code {
    private async Task ShowInfo()
    {
        await ModalService.Info(""Information"", ""This is an informational message."");
    }

    private async Task ShowWarning()
    {
        await ModalService.Warning(""Warning"", ""This action may have consequences."");
    }

    private async Task ShowError()
    {
        await ModalService.Error(""Error"", ""Something went wrong. Please try again."");
    }
}";

    private string confirmDialogCode = @"@inject IModalService ModalService

<BlazyButton Color=""BlazyButtonColor.Primary"" OnClick=""ShowConfirm"">Delete Item</BlazyButton>
<span>Result: @(confirmResult.Value ? ""Confirmed"" : ""Cancelled"")</span>

@code {
    private bool? confirmResult;

    private async Task ShowConfirm()
    {
        confirmResult = await ModalService.Confirm(
            ""Delete Item"",
            ""Are you sure you want to delete this item? This action cannot be undone."");
    }
}";

    private string customButtonsCode = @"await ModalService.Confirm(
    ""Unsaved Changes"",
    ""You have unsaved changes. Do you want to save them before leaving?"",
    confirmText: ""Save"",
    cancelText: ""Discard"");";

    private string customComponentCode = @"// EditUserModal.razor - Custom modal component
@code {
    [CascadingParameter] public ModalInstance Modal { get; set; } = default!;
    [Parameter] public string UserName { get; set; } = """";

    private void Save()
    {
        Modal.Close(userName, confirmed: true);
    }

    private void Cancel()
    {
        Modal.Close(confirmed: false);
    }
}

// Usage:
var parameters = new Dictionary<string, object>
{
    [""UserName""] = ""John Doe""
};

var result = await ModalService.Show<EditUserModal, string>(
    parameters,
    options => options.CssClass = ""max-w-md"");

if (result.Confirmed && result.Data != null)
{
    editedUserName = result.Data;
}";
}
