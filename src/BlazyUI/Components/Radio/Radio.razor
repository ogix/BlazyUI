@namespace BlazyUI
@inherits BlazyInputBase<string>

<input type="radio"
       id="@IdAttributeValue"
       name="@(Name ?? NameAttributeValue)"
       class="@ComputedCssClass"
       value="@OptionValue"
       checked="@IsChecked"
       @onchange="OnChange"
       @attributes="AdditionalAttributes" />

@code {
    /// <summary>
    /// The name attribute for grouping radio buttons.
    /// </summary>
    [Parameter]
    public string? Name { get; set; }

    /// <summary>
    /// The value this radio button represents.
    /// </summary>
    [Parameter]
    public string? OptionValue { get; set; }

    /// <summary>
    /// The size of the radio button.
    /// </summary>
    [Parameter]
    public RadioSize Size { get; set; } = RadioSize.Medium;

    /// <summary>
    /// The color of the radio button.
    /// </summary>
    [Parameter]
    public RadioColor Color { get; set; } = RadioColor.Default;

    /// <inheritdoc />
    protected override string GetErrorColorClass() => "radio-error";

    /// <inheritdoc />
    protected override bool TryParseValueFromString(
        string? value,
        [System.Diagnostics.CodeAnalysis.NotNullWhen(true)] out string result,
        [System.Diagnostics.CodeAnalysis.NotNullWhen(false)] out string? validationErrorMessage)
    {
        result = value ?? string.Empty;
        validationErrorMessage = null;
        return true;
    }

    private bool IsChecked => CurrentValue == OptionValue;

    private string ComputedCssClass => MergeClasses(
        "radio",
        SizeClass,
        ColorClass
    );

    private void OnChange(ChangeEventArgs e)
    {
        if ((bool)(e.Value ?? false))
        {
            CurrentValue = OptionValue ?? string.Empty;
        }
    }

    private string SizeClass => Size switch
    {
        RadioSize.ExtraSmall => "radio-xs",
        RadioSize.Small => "radio-sm",
        RadioSize.Medium => "radio-md",
        RadioSize.Large => "radio-lg",
        RadioSize.ExtraLarge => "radio-xl",
        _ => throw new ArgumentOutOfRangeException(nameof(Size), Size, null)
    };

    private string? ColorClass => Color switch
    {
        RadioColor.Default => null,
        RadioColor.Neutral => "radio-neutral",
        RadioColor.Primary => "radio-primary",
        RadioColor.Secondary => "radio-secondary",
        RadioColor.Accent => "radio-accent",
        RadioColor.Info => "radio-info",
        RadioColor.Success => "radio-success",
        RadioColor.Warning => "radio-warning",
        RadioColor.Error => "radio-error",
        _ => throw new ArgumentOutOfRangeException(nameof(Color), Color, null)
    };
}
