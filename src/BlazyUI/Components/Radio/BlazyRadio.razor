@namespace BlazyUI
@inherits BlazyInputBase<string>

<input type="radio"
       id="@GetFieldId()"
       name="@(Name ?? GetFieldName())"
       class="@ComputedCssClass"
       value="@OptionValue"
       checked="@IsChecked"
       disabled="@Disabled"
       @onchange="OnChange"
       @attributes="AdditionalAttributes" />

@code {
    /// <summary>
    /// The name attribute for grouping radio buttons.
    /// </summary>
    [Parameter]
    public string? Name { get; set; }

    /// <summary>
    /// The value this radio button represents.
    /// </summary>
    [Parameter]
    public string? OptionValue { get; set; }

    /// <summary>
    /// The size of the radio button.
    /// </summary>
    [Parameter]
    public BlazyRadioSize Size { get; set; } = BlazyRadioSize.Medium;

    /// <summary>
    /// The color of the radio button.
    /// </summary>
    [Parameter]
    public BlazyRadioColor Color { get; set; } = BlazyRadioColor.Default;

    /// <inheritdoc />
    protected override string GetErrorColorClass() => "radio-error";

    /// <inheritdoc />
    protected override bool TryParseValueFromString(
        string? value,
        [System.Diagnostics.CodeAnalysis.NotNullWhen(true)] out string result,
        [System.Diagnostics.CodeAnalysis.NotNullWhen(false)] out string? validationErrorMessage)
    {
        result = value ?? string.Empty;
        validationErrorMessage = null;
        return true;
    }

    private bool IsChecked => CurrentValue == OptionValue;

    private string ComputedCssClass => MergeClasses(
        "radio",
        SizeClass,
        ColorClass
    );

    private void OnChange(ChangeEventArgs e)
    {
        // onchange only fires when radio is selected, so just set the value
        CurrentValue = OptionValue ?? string.Empty;
    }

    private string SizeClass => Size switch
    {
        BlazyRadioSize.ExtraSmall => "radio-xs",
        BlazyRadioSize.Small => "radio-sm",
        BlazyRadioSize.Medium => "radio-md",
        BlazyRadioSize.Large => "radio-lg",
        BlazyRadioSize.ExtraLarge => "radio-xl",
        _ => throw new ArgumentOutOfRangeException(nameof(Size), Size, null)
    };

    private string? ColorClass => Color switch
    {
        BlazyRadioColor.Default => null,
        BlazyRadioColor.Neutral => "radio-neutral",
        BlazyRadioColor.Primary => "radio-primary",
        BlazyRadioColor.Secondary => "radio-secondary",
        BlazyRadioColor.Accent => "radio-accent",
        BlazyRadioColor.Info => "radio-info",
        BlazyRadioColor.Success => "radio-success",
        BlazyRadioColor.Warning => "radio-warning",
        BlazyRadioColor.Error => "radio-error",
        _ => throw new ArgumentOutOfRangeException(nameof(Color), Color, null)
    };
}
