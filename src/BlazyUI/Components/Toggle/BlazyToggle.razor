@namespace BlazyUI
@inherits BlazyInputBase<bool>

<input type="checkbox"
       id="@GetFieldId()"
       name="@GetFieldName()"
       class="@ComputedCssClass"
       checked="@CurrentValue"
       @onchange="OnChange"
       @attributes="AdditionalAttributes" />

@code {
    /// <summary>
    /// The size of the toggle.
    /// </summary>
    [Parameter]
    public BlazyToggleSize Size { get; set; } = BlazyToggleSize.Medium;

    /// <summary>
    /// The color of the toggle.
    /// </summary>
    [Parameter]
    public BlazyToggleColor Color { get; set; } = BlazyToggleColor.Default;

    /// <inheritdoc />
    protected override string GetErrorColorClass() => "toggle-error";

    /// <inheritdoc />
    protected override bool TryParseValueFromString(
        string? value,
        [System.Diagnostics.CodeAnalysis.NotNullWhen(true)] out bool result,
        [System.Diagnostics.CodeAnalysis.NotNullWhen(false)] out string? validationErrorMessage)
    {
        if (bool.TryParse(value, out result))
        {
            validationErrorMessage = null;
            return true;
        }

        result = false;
        validationErrorMessage = $"The value '{value}' is not a valid boolean.";
        return false;
    }

    private string ComputedCssClass => MergeClasses(
        "toggle",
        SizeClass,
        ColorClass
    );

    private void OnChange(ChangeEventArgs e)
        => CurrentValue = (bool)(e.Value ?? false);

    private string SizeClass => Size switch
    {
        BlazyToggleSize.ExtraSmall => "toggle-xs",
        BlazyToggleSize.Small => "toggle-sm",
        BlazyToggleSize.Medium => "toggle-md",
        BlazyToggleSize.Large => "toggle-lg",
        BlazyToggleSize.ExtraLarge => "toggle-xl",
        _ => throw new ArgumentOutOfRangeException(nameof(Size), Size, null)
    };

    private string? ColorClass => Color switch
    {
        BlazyToggleColor.Default => null,
        BlazyToggleColor.Neutral => "toggle-neutral",
        BlazyToggleColor.Primary => "toggle-primary",
        BlazyToggleColor.Secondary => "toggle-secondary",
        BlazyToggleColor.Accent => "toggle-accent",
        BlazyToggleColor.Info => "toggle-info",
        BlazyToggleColor.Success => "toggle-success",
        BlazyToggleColor.Warning => "toggle-warning",
        BlazyToggleColor.Error => "toggle-error",
        _ => throw new ArgumentOutOfRangeException(nameof(Color), Color, null)
    };
}
