@namespace BlazyUI
@inherits BlazyInputBase<string>

<input type="@Type"
       id="@GetFieldId()"
       name="@GetFieldName()"
       class="@ComputedCssClass"
       value="@CurrentValue"
       @onchange="OnChange"
       @attributes="AdditionalAttributes" />

@code {
    /// <summary>
    /// The type of input (text, password, email, etc.).
    /// </summary>
    [Parameter]
    public string Type { get; set; } = "text";

    /// <summary>
    /// The size of the input.
    /// </summary>
    [Parameter]
    public BlazyTextInputSize Size { get; set; } = BlazyTextInputSize.Medium;

    /// <summary>
    /// The color of the input.
    /// </summary>
    [Parameter]
    public BlazyTextInputColor Color { get; set; } = BlazyTextInputColor.Default;

    /// <summary>
    /// Applies ghost styling (no background).
    /// </summary>
    [Parameter]
    public bool Ghost { get; set; }

    /// <inheritdoc />
    protected override string GetErrorColorClass() => "input-error";

    /// <inheritdoc />
    protected override bool TryParseValueFromString(
        string? value,
        [System.Diagnostics.CodeAnalysis.NotNullWhen(true)] out string? result,
        [System.Diagnostics.CodeAnalysis.NotNullWhen(false)] out string? validationErrorMessage)
    {
        result = value ?? string.Empty;
        validationErrorMessage = null;
        return true;
    }

    private string ComputedCssClass => MergeClasses(
        "input",
        SizeClass,
        ColorClass,
        Ghost ? "input-ghost" : null
    );

    private void OnChange(ChangeEventArgs e)
        => CurrentValue = e.Value?.ToString();

    private string SizeClass => Size switch
    {
        BlazyTextInputSize.ExtraSmall => "input-xs",
        BlazyTextInputSize.Small => "input-sm",
        BlazyTextInputSize.Medium => "input-md",
        BlazyTextInputSize.Large => "input-lg",
        BlazyTextInputSize.ExtraLarge => "input-xl",
        _ => throw new ArgumentOutOfRangeException(nameof(Size), Size, null)
    };

    private string? ColorClass => Color switch
    {
        BlazyTextInputColor.Default => null,
        BlazyTextInputColor.Neutral => "input-neutral",
        BlazyTextInputColor.Primary => "input-primary",
        BlazyTextInputColor.Secondary => "input-secondary",
        BlazyTextInputColor.Accent => "input-accent",
        BlazyTextInputColor.Info => "input-info",
        BlazyTextInputColor.Success => "input-success",
        BlazyTextInputColor.Warning => "input-warning",
        BlazyTextInputColor.Error => "input-error",
        _ => throw new ArgumentOutOfRangeException(nameof(Color), Color, null)
    };
}
